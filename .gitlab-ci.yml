# sudo apt-get install gcc-arm-none-eabi binutils-arm-none-eabi gdb-arm-none-eabi openocd

image:
    name: debian
    
variables:
    GIT_SUBMODULE_STRATEGY: recursive

before_script:  
    - apt-get update
    - apt-get install gcc-arm-none-eabi binutils-arm-none-eabi cmake

stages:
    - pages
    - build
    - test

build:
    stage: build
    script: time CLEANBUILD=true ./build.sh
    cache:
        key: build-cache
        paths:
        - build/Drivers
        - build/Middlewares
    artifacts:
        paths:
            - build/Rflw.bin
        expire_in: 1 week

test:
    stage: test
    script: file build/Rflw.bin

pages:
    stage: pages
    script: 
    - doxygen Rflw
    - mv docs/html/ public/
    artifacts:
        paths:
        - public
    only:
    - master
